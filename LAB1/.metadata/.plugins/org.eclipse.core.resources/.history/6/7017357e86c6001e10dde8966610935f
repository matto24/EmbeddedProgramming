#include <stdint.h>
#include <stdbool.h>
#include "tm4c123gh6pm.h"

/**
 * main.c
 */
int main(void)
{
    int dummy;

    //Enable the GPIO port that is used for the on-board LEDs and switches
    SYSCTL_RCGC2_R = SYSCTL_RCGC2_GPIOF;

    //Do a dummy read to insert a few cycles after enabling the peripheral
    dummy = SYSCTL_RCGC2_R;

    //Set the direction as output (PF1-PF3)
    GPIO_PORTF_DIR_R = 0x0E;

    //Enable the GPIO pins for digital function (PF1-PF4)
    GPIO_PORTF_DEN_R = 0x1E;

    //Enable internal pull-up (PF4)
    //Done to ensure the input pin is pulled to a high level when the button is not pressed
    GPIO_PORTF_PUR_R = 0x10;

    int count = 0;
    int color[] = {0x00,0x08,0x04,0x0C,0x02,0x0A,0x06,0x0E};
    bool countsUp = true;
    bool buttonPressed = false;

    while(1) {
        //Check if button is not pressed.
        if (GPIO_PORTF_DATA_R & 0x10) {
            if(buttonPressed){
                //Button is pressed
                buttonPressed = false;
                            if(countsUp) {
                                if(count<8) {
                                    count = count+1;
                                } else {
                                    count = 0;
                                }
                            } else {
                                if(count>0) {
                                    count = count-1;
                                } else {
                                    count = 7;
                                }
                            }
            //Delay for debouncing
            for(int i =0; i< 1000; i++);

            }
             //Turns the LED ON.
            GPIO_PORTF_DATA_R = color[count];

        } else  {
            buttonPressed = true;
            //Wait

        }
    }
    return(0);
}

